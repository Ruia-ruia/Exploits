/* Malloc is grossly overpowered. I wish to prove it */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
 
typedef struct sized_chunk {
  struct sized_chunk *fd;
  struct sized_chunk *bk;
  char buf[0x20];
} sized_chunk;

void make_tape(int length) {
        char *pts[7];
        unsigned long *c = malloc(10);
        struct sized_chunk *all_ptrs[length];

        //fill t-cache
        for (int i = 0; i < 7; ++i) {
                pts[i] = malloc(10);
        }

        for (int i = 0; i < 7; ++i) {
                free(pts[i]);
        }

        //make tape 
        all_ptrs[0] = malloc(sizeof(sized_chunk));
        for (int i = 1; i < length; ++i) {
                all_ptrs[i] = malloc(sizeof(sized_chunk));
                all_ptrs[i] -> fd = (char *)all_ptrs[i - 1] - 16;
        }

        free(c);
        *c = (char *)all_ptrs[length - 1] - 16;
}


void transition_head(char *overflow, char *transit, int list_a, int list_b, size_t size) {
        free(transit);
        *((char *)overflow + size + 4) = list_b;

        malloc(list_a - 0x10);
        free(transit);
}


int main(void) {
	make_tape(1000); 	//the arbitrary length of the tape 

  	return 0;
}
